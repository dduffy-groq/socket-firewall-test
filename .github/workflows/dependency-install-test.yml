# Dependency Install Test
#
# Tests Socket detection using the reusable workflow

name: Dependency Install Test

on:
  push:
    branches: [main]
  pull_request:
  workflow_dispatch:

jobs:
  # Use the centralized Socket security workflow
  socket-scan:
    name: Socket Security (Centralized)
    uses: dduffy-groq/socket-firewall-configurator/.github/workflows/socket-security-reusable.yml@main
    permissions:
      contents: read
      pull-requests: write
      issues: write
    with:
      enable_comments: true
      fail_on_error: true
    secrets:
      SOCKET_SECURITY_API_KEY: ${{ secrets.SOCKET_SECURITY_API_KEY }}

  # Summary
  summary:
    name: Test Summary
    runs-on: ubuntu-latest
    needs: socket-scan
    if: always()
    steps:
      - name: Summary
        run: |
          echo "=== Socket Security Test Summary ==="
          echo ""
          echo "socket-scan: ${{ needs.socket-scan.result }}"
          echo ""
          echo "This test uses the centralized Socket security workflow"
          echo "from socket-firewall-configurator."
          echo ""
          echo "Expected: Should detect faker@6.6.6 protestware"
